<!DOCTYPE <!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
        BAGGINS BOOKS YA HEARD
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <style>
    #mainPage{
        display: none;
    }
    </style>
</head>
<body>
     <!--Links ALASQL Plugin to your webpage-->
     <script src="http://cdn.jsdelivr.net/alasql/latest/alasql.min.js"></script>
     
     <!--Use ALASQL in your js file-->
     <script>console.log(alasql);
     var db = new alasql.Database();
     

     db.exec('CREATE TABLE users (' +
         'id int PRIMARY KEY,' +
'username varchar(255), ' + 
 'password varchar(255), '+
'address varchar(255)' + ')' 
);

db.exec('CREATE TABLE books (' +
 'id int PRIMARY KEY,' +
 'title varchar(255), ' +
 'author varchar(255), ' +
 'genre varchar(255), ' +
    'year int, ' + 
'price float' + ')'
);

db.exec('CREATE TABLE usersBooks (' +
'id int PRIMARY KEY, ' +
'uid int, ' +
'bid int ' +
')'
);

db.exec('INSERT INTO books VALUES(0, "Moby_Dick", "Herman Melville", "fiction", 1851, 8.95 )');
db.exec('INSERT INTO books VALUES(1, "Harry Potter", "J.K Rowling", "fantasy", 1998, 30.00 )');
db.exec('INSERT INTO books VALUES(2, "Matilda", "Roald Dahl", "fantasy", 1988, 3.00 )');
db.exec('INSERT INTO users VALUES(0, "Free", "mgapxl", "dead niece road" )');

console.log(db.exec('SELECT * FROM users'));

function login(){
    var un = document.getElementById("name").value;
    var pw = document.getElementById("password").value;
    var results = db.exec(`select * FROM users WHERE username="${un}" AND password="${pw}"`);
    console.log(results[0])
    if (results.length == 0) {
        alert("incorrect username/password")
    }

    else{
        alert('Welcome' + results[0].username);
        document.getElementById('loginPage').style.display = 'none';
        document.getElementById('mainPage').style.display = 'block';
    }

}

function signUp(){
    var un = document.getElementById("newName").value;
    var pw = document.getElementById("pass1").value;
    var pw2 = document.getElementById("pass2").value;
    var ad = document.getElementById("newName").value;
    var id = db.exec('SELECT * FROM users').length + 1;

    if (pw != pw2){
        alert("passwords do not match, try again");
    }
    else{
        db.exec(`INSERT INTO users VALUES("${id}", "${un}", "${pw}", "${ad}" )`);
        alert('welcome' + un)
    }

}

function search(){
    var category = document.getElementById('category').value;
    var input = document.getElementById('input').value;
    db.exec(`SELECT * FROM books WHERE "${category}"="${input}"`);
    var display = document.getElementById('results');
    display.innerHTML = '';
    for (var i =0; i< results.length; i++){
        var li =document.createElement('li');
        li.innerHTML = results[i].title + ' | ' + results[i].price;
        display.appendChild(li);
    }
}



     </script>



 
    
<div id ="loginPage">
        <div class="container">
                <div class="row">            
                    <div class="col-2 mr-auto">
                       Login
                       <br>
                           <input type="text" placeholder="enter username" id="name"> 
                           <br>
                           <input type="password" placeholder="enter password" id="password">
                           <br>
                           <input value="submit" type="button" onclick="login()">
           
                       </div>
                   </div>
               </div>
<div class="container">
        <div class="row">
                <div class="col-2 ml-auto mr-auto">
                        <h1>Sign up</h1>
        <input type="text" placeholder="enter username" id="newName"> 
        <br>
        <input type="text" placeholder="address" id="address">
        <br>
        <input type="password" placeholder="enter password" id="pass1">
        <br>
        <input type="password" placeholder="verify password" id="pass2">
        <br>
        <input value="submit" type="button" onclick="signUp()">

                
    </div>
    
        </div>
        
        </div>
        </div>
    </div>

    <div id= "mainPage">
        <h1>Main Page</h1>
        <div class="container-fluid">
            <div class="row">
                <div class="col"> 
                    <select>
                        <option value="author">
                            author
                        </option>
                        <option value="title">
                                title
                            </option>
                            <option value="year">
                                    year
                                </option>
                                <option value="price">
                                        price
                                    </option>
                                    <option value="price">
                                            price
                                        </option>
                        
                    </select>
                    <input value="search" type="text" id="input" onchange="search()">                    
                    <h1>Results</h1>
                        <ul id="results">
                            
                        </ul>

                </div>
                <div class="col-4">
                    <h1>Cart</h1>
                    <h3 id='total'></h3>
                </div>
            </div>
        </div>

    </div>



</body>
</html>


<!-- we want:
a many to many relationship between tables and books
users:
    name: varChar
    password: varChar
    id:int
    address: varChar
books: 
    id: int
    title: varChar
    author: varChar
    genre: varChar
    year: date
    price: float/double
    -->


    